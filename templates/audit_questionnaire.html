{% extends 'base.html' %}

{% block title %}Audit Questionnaire - MGMU IQAC{% endblock %}

{% block content %}
<h2>Audit Questionnaire</h2>
<div style="max-width:800px; margin-top:12px;">
  <h3>{{ report.title }}</h3>
  <p><strong>Content:</strong> {{ report.content }}</p>

  <form method="POST">
    {% for i, q in enumerate(questions) %}
      <div style="margin-bottom:8px;">
        <label>{{ loop.index }}. {{ q }}</label><br>
        <label><input type="radio" name="q_{{ i }}" value="Y" {% if report.audit_answers and report.audit_answers.get(q) == 'Y' %}checked{% endif %}> Y</label>
        <label style="margin-left:10px;"><input type="radio" name="q_{{ i }}" value="N" {% if report.audit_answers and report.audit_answers.get(q) == 'N' %}checked{% endif %}> N</label>
      </div>
    {% endfor %}

    <label for="institute">Institute (optional)</label>
    <select id="institute" name="institute">
      <option value="">-- Select Institute --</option>
      {% for inst in institutes %}
        <option value="{{ inst }}" {% if report.audited_institute == inst %}selected{% endif %}>{{ inst }}</option>
      {% endfor %}
    </select>

    <label for="grade">Grade</label>
    <select id="grade" name="grade" required>
      <option value="">-- Select Grade --</option>
      <option value="A+">A+</option>
      <option value="A">A</option>
      <option value="B+">B+</option>
      <option value="B">B</option>
      <option value="C+">C+</option>
      <option value="C">C</option>
      <option value="D">D</option>
      <option value="F">F</option>
    </select>

    <label>Notes</label>
    <textarea name="auditor_notes" rows="3">{{ report.auditor_notes }}</textarea>

    <div style="margin-top:12px;">
      <button type="submit">Submit Audit</button>
      <a href="{{ url_for('audit_reports') }}"><button type="button">Cancel</button></a>
    </div>
  </form>

  {% if report.audit_answers %}
    <div style="margin-top:18px; border-top:1px solid #eee; padding-top:12px;">
      <h4>Previous Answers</h4>
      <ul>
        {% for q, a in report.audit_answers.items() %}
          <li>{{ q }}: {{ a }}</li>
        {% endfor %}
      </ul>
      {% if report.audit_grade %}
        <p><strong>Assigned Grade:</strong> {{ report.audit_grade }}</p>
      {% endif %}
    </div>
  {% endif %}

</div>
{% endblock %}
